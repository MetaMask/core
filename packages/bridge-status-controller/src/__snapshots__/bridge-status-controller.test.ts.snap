// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`BridgeStatusController constructor rehydrates the tx history state 1`] = `
{
  "bridgeTxMetaId1": {
    "account": "0xaccount1",
    "actionId": undefined,
    "approvalTxId": undefined,
    "attempts": undefined,
    "batchId": undefined,
    "completionTime": undefined,
    "estimatedProcessingTimeInSeconds": 15,
    "featureId": undefined,
    "hasApprovalTx": false,
    "initialDestAssetBalance": undefined,
    "isStxEnabled": false,
    "location": undefined,
    "originalTransactionId": "bridgeTxMetaId1",
    "pricingData": {
      "amountSent": "1.234",
      "amountSentInUsd": undefined,
      "quotedGasAmount": ".00055",
      "quotedGasInUsd": "2.5778",
      "quotedReturnInUsd": undefined,
    },
    "quote": {
      "bridgeId": "lifi",
      "bridges": [
        "across",
      ],
      "destAsset": {
        "address": "0x0000000000000000000000000000000000000000",
        "assetId": "eip155:10/slip44:60",
        "chainId": 10,
        "coinKey": "ETH",
        "decimals": 18,
        "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "name": "ETH",
        "priceUSD": "2478.63",
        "symbol": "ETH",
      },
      "destChainId": 10,
      "destTokenAmount": "990654755978612",
      "feeData": {
        "metabridge": {
          "amount": "8750000000000",
          "asset": {
            "address": "0x0000000000000000000000000000000000000000",
            "assetId": "eip155:42161/slip44:60",
            "chainId": 42161,
            "coinKey": "ETH",
            "decimals": 18,
            "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "name": "ETH",
            "priceUSD": "2478.7",
            "symbol": "ETH",
          },
        },
      },
      "minDestTokenAmount": "941000000000000",
      "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
      "srcAsset": {
        "address": "0x0000000000000000000000000000000000000000",
        "assetId": "eip155:42161/slip44:60",
        "chainId": 42161,
        "coinKey": "ETH",
        "decimals": 18,
        "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "name": "ETH",
        "priceUSD": "2478.7",
        "symbol": "ETH",
      },
      "srcChainId": 42161,
      "srcTokenAmount": "991250000000000",
      "steps": [
        {
          "action": "bridge",
          "destAmount": "990654755978612",
          "destAsset": {
            "address": "0x0000000000000000000000000000000000000000",
            "assetId": "eip155:10/slip44:60",
            "chainId": 10,
            "coinKey": "ETH",
            "decimals": 18,
            "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "name": "ETH",
            "priceUSD": "2478.63",
            "symbol": "ETH",
          },
          "destChainId": 10,
          "protocol": {
            "displayName": "Across",
            "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
            "name": "across",
          },
          "srcAmount": "991250000000000",
          "srcAsset": {
            "address": "0x0000000000000000000000000000000000000000",
            "assetId": "eip155:42161/slip44:60",
            "chainId": 42161,
            "coinKey": "ETH",
            "decimals": 18,
            "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "name": "ETH",
            "priceUSD": "2478.7",
            "symbol": "ETH",
          },
          "srcChainId": 42161,
        },
      ],
    },
    "slippagePercentage": 0,
    "startTime": 1729964825189,
    "status": {
      "destChain": {
        "chainId": 10,
        "token": {},
      },
      "srcChain": {
        "amount": "991250000000000",
        "chainId": 42161,
        "token": {
          "address": "0x0000000000000000000000000000000000000000",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2518.47",
          "symbol": "ETH",
        },
        "txHash": "0xsrcTxHash1",
      },
      "status": "PENDING",
    },
    "targetContractAddress": "0x23981fC34e69eeDFE2BD9a0a9fCb0719Fe09DbFC",
    "txMetaId": "bridgeTxMetaId1",
  },
}
`;

exports[`BridgeStatusController constructor should setup correctly 1`] = `
[
  [
    "TransactionController:transactionFailed",
    [Function],
  ],
  [
    "TransactionController:transactionConfirmed",
    [Function],
  ],
]
`;

exports[`BridgeStatusController startPollingForBridgeTxStatus emits bridgeTransactionFailed event when the status response is failed 1`] = `
[
  [
    "AuthenticationController:getBearerToken",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "actual_time_minutes": 105213.34261666666,
      "allowance_reset_transaction": undefined,
      "approval_transaction": undefined,
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": true,
      "destination_transaction": "FAILED",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quote_vs_execution_ratio": 0,
      "quoted_time_minutes": 0.25,
      "quoted_vs_used_gas_ratio": 0,
      "security_warnings": [],
      "slippage_limit": 0,
      "source_transaction": "COMPLETE",
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_address_destination": "eip155:10/slip44:60",
      "token_address_source": "eip155:42161/slip44:60",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_actual_gas": 0,
      "usd_actual_return": 0,
      "usd_amount_source": 0,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
]
`;

exports[`BridgeStatusController startPollingForBridgeTxStatus sets the inital tx history state 1`] = `
{
  "bridgeTxMetaId1": {
    "account": "0xaccount1",
    "actionId": undefined,
    "approvalTxId": undefined,
    "batchId": undefined,
    "estimatedProcessingTimeInSeconds": 15,
    "featureId": undefined,
    "hasApprovalTx": false,
    "initialDestAssetBalance": undefined,
    "isStxEnabled": false,
    "location": undefined,
    "originalTransactionId": "bridgeTxMetaId1",
    "pricingData": {
      "amountSent": "1.234",
      "amountSentInUsd": undefined,
      "quotedGasAmount": ".00055",
      "quotedGasInUsd": "2.5778",
      "quotedReturnInUsd": undefined,
    },
    "quote": {
      "bridgeId": "lifi",
      "bridges": [
        "across",
      ],
      "destAsset": {
        "address": "0x0000000000000000000000000000000000000000",
        "assetId": "eip155:10/slip44:60",
        "chainId": 10,
        "coinKey": "ETH",
        "decimals": 18,
        "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "name": "ETH",
        "priceUSD": "2478.63",
        "symbol": "ETH",
      },
      "destChainId": 10,
      "destTokenAmount": "990654755978612",
      "feeData": {
        "metabridge": {
          "amount": "8750000000000",
          "asset": {
            "address": "0x0000000000000000000000000000000000000000",
            "assetId": "eip155:42161/slip44:60",
            "chainId": 42161,
            "coinKey": "ETH",
            "decimals": 18,
            "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "name": "ETH",
            "priceUSD": "2478.7",
            "symbol": "ETH",
          },
        },
      },
      "minDestTokenAmount": "941000000000000",
      "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
      "srcAsset": {
        "address": "0x0000000000000000000000000000000000000000",
        "assetId": "eip155:42161/slip44:60",
        "chainId": 42161,
        "coinKey": "ETH",
        "decimals": 18,
        "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
        "name": "ETH",
        "priceUSD": "2478.7",
        "symbol": "ETH",
      },
      "srcChainId": 42161,
      "srcTokenAmount": "991250000000000",
      "steps": [
        {
          "action": "bridge",
          "destAmount": "990654755978612",
          "destAsset": {
            "address": "0x0000000000000000000000000000000000000000",
            "assetId": "eip155:10/slip44:60",
            "chainId": 10,
            "coinKey": "ETH",
            "decimals": 18,
            "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "name": "ETH",
            "priceUSD": "2478.63",
            "symbol": "ETH",
          },
          "destChainId": 10,
          "protocol": {
            "displayName": "Across",
            "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
            "name": "across",
          },
          "srcAmount": "991250000000000",
          "srcAsset": {
            "address": "0x0000000000000000000000000000000000000000",
            "assetId": "eip155:42161/slip44:60",
            "chainId": 42161,
            "coinKey": "ETH",
            "decimals": 18,
            "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
            "name": "ETH",
            "priceUSD": "2478.7",
            "symbol": "ETH",
          },
          "srcChainId": 42161,
        },
      ],
    },
    "slippagePercentage": 0,
    "startTime": 1729964825189,
    "status": {
      "srcChain": {
        "chainId": 42161,
        "txHash": "0xsrcTxHash1",
      },
      "status": "PENDING",
    },
    "targetContractAddress": "0x23981fC34e69eeDFE2BD9a0a9fCb0719Fe09DbFC",
    "txMetaId": "bridgeTxMetaId1",
  },
}
`;

exports[`BridgeStatusController startPollingForBridgeTxStatus stops polling when the status response is complete 1`] = `
[
  [
    "AuthenticationController:getBearerToken",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Completed",
    {
      "action_type": "swapbridge-v1",
      "actual_time_minutes": 105213.34261666666,
      "allowance_reset_transaction": undefined,
      "approval_transaction": undefined,
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": true,
      "destination_transaction": "COMPLETE",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quote_vs_execution_ratio": 0,
      "quoted_time_minutes": 0.25,
      "quoted_vs_used_gas_ratio": 0,
      "security_warnings": [],
      "slippage_limit": 0,
      "source_transaction": "COMPLETE",
      "stx_enabled": true,
      "swap_type": "crosschain",
      "token_address_destination": "eip155:10/slip44:60",
      "token_address_source": "eip155:42161/slip44:60",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_actual_gas": 0,
      "usd_actual_return": 0,
      "usd_amount_source": 0,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
]
`;

exports[`BridgeStatusController startPollingForBridgeTxStatus stops polling when the status response is complete 2`] = `
[
  "BridgeStatusController:destinationTransactionCompleted",
  "eip155:10/slip44:60",
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should call handleMobileHardwareWalletDelay for hardware wallet on mobile 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should call handleMobileHardwareWalletDelay for hardware wallet on mobile 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": "test-approval-tx-id",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should call handleMobileHardwareWalletDelay for hardware wallet on mobile 3`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": true,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should call handleMobileHardwareWalletDelay for hardware wallet on mobile 4`] = `
[
  [
    {
      "data": {
        "srcChainId": "eip155:42161",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Completed",
    },
    [Function],
  ],
  [
    {
      "data": {
        "srcChainId": "eip155:42161",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Approval Completed",
    },
    [Function],
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting base approval 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting base approval 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": "test-approval-tx-id",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 8453,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 8453,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting base approval 3`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "otherAccount",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:8453",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting base approval 4`] = `
[
  [
    {
      "data": {
        "srcChainId": "eip155:8453",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Completed",
    },
    [Function],
  ],
  [
    {
      "data": {
        "srcChainId": "eip155:8453",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Approval Completed",
    },
    [Function],
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting linea approval 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting linea approval 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": "test-approval-tx-id",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 59144,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 59144,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting linea approval 3`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "otherAccount",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:59144",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should delay after submitting linea approval 4`] = `
[
  [
    {
      "data": {
        "srcChainId": "eip155:59144",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Completed",
    },
    [Function],
  ],
  [
    {
      "data": {
        "srcChainId": "eip155:59144",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Approval Completed",
    },
    [Function],
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should handle smart transactions and include quotesReceivedContext 1`] = `
{
  "batchId": "batchId1",
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should handle smart transactions and include quotesReceivedContext 2`] = `
{
  "account": "0xaccount1",
  "actionId": undefined,
  "approvalTxId": undefined,
  "batchId": "batchId1",
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": false,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": true,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should handle smart transactions and include quotesReceivedContext 3`] = `
[
  [
    {
      "chainId": "0xa4b1",
      "networkClientId": "arbitrum",
      "transactionParams": {
        "data": "0xdata",
        "from": "0xaccount1",
        "gas": "21000",
        "to": "0xbridgeContract",
        "value": "0x0",
      },
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should handle smart transactions and include quotesReceivedContext 4`] = `
[
  [
    {
      "disable7702": true,
      "from": "0xaccount1",
      "isGasFeeIncluded": false,
      "isGasFeeSponsored": false,
      "networkClientId": "arbitrum",
      "origin": "metamask",
      "requireApproval": false,
      "transactions": [
        {
          "assetsFiatValues": {
            "receiving": "2.9999",
            "sending": "2.00",
          },
          "params": {
            "data": "0xdata",
            "from": "0xaccount1",
            "gas": "0x5208",
            "maxFeePerGas": "0x0",
            "maxPriorityFeePerGas": "0x0",
            "to": "0xbridgeContract",
            "value": "0x0",
          },
          "type": "bridge",
        },
      ],
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should handle smart transactions and include quotesReceivedContext 5`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    {
      "best_quote_provider": "lifi_across",
      "can_submit": true,
      "gas_included": false,
      "gas_included_7702": false,
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "usd_balance_source": 0,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0.134214,
      "warnings": [
        "low_return",
      ],
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": true,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay on extension 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay on extension 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": "test-approval-tx-id",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay on extension 3`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "otherAccount",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay on extension 4`] = `
[
  [
    {
      "data": {
        "srcChainId": "eip155:42161",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Completed",
    },
    [Function],
  ],
  [
    {
      "data": {
        "srcChainId": "eip155:42161",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Approval Completed",
    },
    [Function],
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay with true for non-hardware wallet on mobile 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay with true for non-hardware wallet on mobile 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": "test-approval-tx-id",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay with true for non-hardware wallet on mobile 3`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should not call handleMobileHardwareWalletDelay with true for non-hardware wallet on mobile 4`] = `
[
  [
    {
      "data": {
        "srcChainId": "eip155:42161",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Completed",
    },
    [Function],
  ],
  [
    {
      "data": {
        "srcChainId": "eip155:42161",
        "stxEnabled": false,
      },
      "name": "Bridge Transaction Approval Completed",
    },
    [Function],
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should reset USDT allowance 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should reset USDT allowance 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": "test-approval-tx-id",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should reset USDT allowance 3`] = `
[
  [
    {
      "chainId": "0x1",
      "networkClientId": "arbitrum-client-id",
      "transactionParams": {
        "chainId": "0x1",
        "data": "0x095ea7b3000000000000000000000000881d40237659c251811cec9c364ef91dc08d300c0000000000000000000000000000000000000000000000000000000000000000",
        "from": "0xaccount1",
        "gas": "21000",
        "gasLimit": "21000",
        "to": "0xtokenContract",
        "value": "0x0",
      },
    },
  ],
  [
    {
      "chainId": "0xa4b1",
      "networkClientId": "arbitrum-client-id",
      "transactionParams": {
        "chainId": "0xa4b1",
        "data": "0xapprovalData",
        "from": "0xaccount1",
        "gas": "21000",
        "gasLimit": "21000",
        "to": "0xtokenContract",
        "value": "0x0",
      },
    },
  ],
  [
    {
      "chainId": "0xa4b1",
      "networkClientId": "arbitrum",
      "transactionParams": {
        "chainId": "0xa4b1",
        "data": "0xdata",
        "from": "0xaccount1",
        "gas": "21000",
        "gasLimit": "21000",
        "to": "0xbridgeContract",
        "value": "0x0",
      },
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should reset USDT allowance 4`] = `
[
  [
    {
      "chainId": "0x1",
      "data": "0x095ea7b3000000000000000000000000881d40237659c251811cec9c364ef91dc08d300c0000000000000000000000000000000000000000000000000000000000000000",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xtokenContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum-client-id",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridgeApproval",
    },
  ],
  [
    {
      "chainId": "0xa4b1",
      "data": "0xapprovalData",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xtokenContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum-client-id",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridgeApproval",
    },
  ],
  [
    {
      "chainId": "0xa4b1",
      "data": "0xdata",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xbridgeContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridge",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should reset USDT allowance 5`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0x1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with approval 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with approval 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": "test-approval-tx-id",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with approval 3`] = `
[
  [
    {
      "chainId": "0xa4b1",
      "data": "0xapprovalData",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xtokenContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum-client-id",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridgeApproval",
    },
  ],
  [
    {
      "chainId": "0xa4b1",
      "data": "0xdata",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xbridgeContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridge",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with approval 4`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "otherAccount",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with no approval 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "txReceipt": {
    "effectiveGasPrice": "0x1880a",
    "gasUsed": "0x2c92a",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with no approval 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": undefined,
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 15,
  "featureId": undefined,
  "hasApprovalTx": false,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000032",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "WETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "WETH",
      "priceUSD": "2478.63",
      "symbol": "WETH",
    },
    "destChainId": 10,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with no approval 3`] = `
[
  [
    {
      "chainId": "0xa4b1",
      "networkClientId": "arbitrum",
      "transactionParams": {
        "chainId": "0xa4b1",
        "data": "0xdata",
        "from": "0xaccount1",
        "gas": "21000",
        "gasLimit": "21000",
        "to": "0xbridgeContract",
        "value": "0x0",
      },
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with no approval 4`] = `
[
  [
    {
      "chainId": "0xa4b1",
      "data": "0xdata",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xbridgeContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridge",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should successfully submit an EVM bridge transaction with no approval 5`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "WETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should throw an error if approval tx fails 1`] = `
[
  [
    {
      "chainId": "0xa4b1",
      "data": "0xapprovalData",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xtokenContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum-client-id",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridgeApproval",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should throw an error if approval tx fails 2`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should throw an error if approval tx meta does not exist 1`] = `
[
  [
    {
      "chainId": "0xa4b1",
      "data": "0xapprovalData",
      "from": "0xaccount1",
      "gas": "0x5208",
      "gasLimit": "21000",
      "maxFeePerGas": undefined,
      "maxPriorityFeePerGas": undefined,
      "to": "0xtokenContract",
      "value": "0x0",
    },
    {
      "actionId": "1234567890.456",
      "networkClientId": "arbitrum-client-id",
      "origin": "metamask",
      "requireApproval": false,
      "type": "bridgeApproval",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM bridge should throw an error if approval tx meta does not exist 2`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:10",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0.25,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM swap should estimate gas when gasIncluded is false and STX is off 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should handle smart transactions 1`] = `
{
  "batchId": "batchId1",
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should handle smart transactions 2`] = `
{
  "account": "0xaccount1",
  "actionId": undefined,
  "approvalTxId": undefined,
  "batchId": "batchId1",
  "estimatedProcessingTimeInSeconds": 0,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": true,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 42161,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should handle smart transactions 3`] = `
[
  [
    {
      "chainId": "0xa4b1",
      "networkClientId": "arbitrum",
      "transactionParams": {
        "data": "0xapprovalData",
        "from": "0xaccount1",
        "gas": "21000",
        "to": "0xtokenContract",
        "value": "0x0",
      },
    },
  ],
  [
    {
      "chainId": "0xa4b1",
      "networkClientId": "arbitrum",
      "transactionParams": {
        "data": "0xdata",
        "from": "0xaccount1",
        "gas": "21000",
        "to": "0xbridgeContract",
        "value": "0x0",
      },
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM swap should handle smart transactions 4`] = `
[
  [
    {
      "disable7702": true,
      "from": "0xaccount1",
      "isGasFeeIncluded": false,
      "isGasFeeSponsored": false,
      "networkClientId": "arbitrum",
      "origin": "metamask",
      "requireApproval": false,
      "transactions": [
        {
          "params": {
            "data": "0xapprovalData",
            "from": "0xaccount1",
            "gas": "0x5208",
            "maxFeePerGas": "0x0",
            "maxPriorityFeePerGas": "0x0",
            "to": "0xtokenContract",
            "value": "0x0",
          },
          "type": "swapApproval",
        },
        {
          "assetsFiatValues": {
            "receiving": "2.9999",
            "sending": "2.00",
          },
          "params": {
            "data": "0xdata",
            "from": "0xaccount1",
            "gas": "0x5208",
            "maxFeePerGas": "0x0",
            "maxPriorityFeePerGas": "0x0",
            "to": "0xbridgeContract",
            "value": "0x0",
          },
          "type": "swap",
        },
      ],
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM swap should handle smart transactions 5`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:42161",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0,
      "stx_enabled": true,
      "swap_type": "single_chain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM swap should successfully submit an EVM swap transaction with approval 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should successfully submit an EVM swap transaction with featureId 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should successfully submit an EVM swap transaction with featureId 2`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM swap should successfully submit an EVM swap transaction with no approval 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should successfully submit an EVM swap transaction with no approval 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": undefined,
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 0,
  "featureId": undefined,
  "hasApprovalTx": false,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000032",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "WETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "WETH",
      "priceUSD": "2478.63",
      "symbol": "WETH",
    },
    "destChainId": 42161,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
    },
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should successfully submit an EVM swap transaction with no approval 3`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:42161",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quoted_time_minutes": 0,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "WETH",
      "token_symbol_source": "ETH",
      "usd_amount_source": 1.01,
      "usd_quoted_gas": 2.5778,
      "usd_quoted_return": 0,
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "NetworkController:findNetworkClientIdByChainId",
    "0xa4b1",
  ],
  [
    "GasFeeController:getState",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: EVM swap should use batch path when gasIncluded7702 is true regardless of STX setting 1`] = `
{
  "batchId": "batchId1",
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should use quote txFee when gasIncluded is true and STX is off (Max native token swap) 1`] = `
{
  "chainId": "0xa4b1",
  "hash": "0xevmTxHash",
  "id": "test-tx-id",
  "status": "unapproved",
  "time": 1234567890,
  "txParams": {
    "chainId": "0xa4b1",
    "data": "0xdata",
    "from": "0xaccount1",
    "gasLimit": "0x5208",
    "to": "0xbridgeContract",
    "value": "0x0",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: EVM swap should use quote txFee when gasIncluded is true and STX is off (Max native token swap) 2`] = `
{
  "account": "0xaccount1",
  "actionId": "1234567890.456",
  "approvalTxId": undefined,
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 0,
  "featureId": undefined,
  "hasApprovalTx": false,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "test-tx-id",
  "pricingData": {
    "amountSent": "1.234",
    "amountSentInUsd": "1.01",
    "quotedGasAmount": ".00055",
    "quotedGasInUsd": "2.5778",
    "quotedReturnInUsd": "0.134214",
  },
  "quote": {
    "bridgeId": "lifi",
    "bridges": [
      "across",
    ],
    "destAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:10/slip44:60",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "destChainId": 42161,
    "destTokenAmount": "990654755978612",
    "feeData": {
      "metabridge": {
        "amount": "8750000000000",
        "asset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
      },
      "txFee": {
        "maxFeePerGas": "1395348",
        "maxPriorityFeePerGas": "1000001",
      },
    },
    "gasIncluded": true,
    "gasIncluded7702": false,
    "minDestTokenAmount": "941000000000000",
    "requestId": "197c402f-cb96-4096-9f8c-54aed84ca776",
    "srcAsset": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "srcChainId": 42161,
    "srcTokenAmount": "991250000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "990654755978612",
        "destAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:10/slip44:60",
          "chainId": 10,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.63",
          "symbol": "ETH",
        },
        "destChainId": 10,
        "protocol": {
          "displayName": "Across",
          "icon": "https://raw.githubusercontent.com/lifinance/types/main/src/assets/icons/bridges/acrossv2.png",
          "name": "across",
        },
        "srcAmount": "991250000000000",
        "srcAsset": {
          "address": "0x0000000000000000000000000000000000000000",
          "assetId": "eip155:42161/slip44:60",
          "chainId": 42161,
          "coinKey": "ETH",
          "decimals": 18,
          "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
          "name": "ETH",
          "priceUSD": "2478.7",
          "symbol": "ETH",
        },
        "srcChainId": 42161,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 42161,
      "txHash": "0xevmTxHash",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "test-tx-id",
}
`;

exports[`BridgeStatusController submitTx: Solana bridge should handle snap controller errors 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "SOLaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:1",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_test-bridge",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "solana-account-1",
          "scope": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
          "transaction": "AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAQAHDXLY8oVRIwA8ZdRSGjM5RIZJW8Wv+Twyw3NqU4Hov+OHoHp/dmeDvstKbICW3ezeGR69t3/PTAvdXgZVdJFJXaxkoKXUTWfEAyQyCCG9nwVoDsd10OFdnM9ldSi+9SLqHpqWVDV+zzkmftkF//DpbXxqeH8obNXHFR7pUlxG9uNVOn64oNsFdeUvD139j1M51iRmUY839Y25ET4jDRscT081oGb+rLnywLjLSrIQx6MkqNBhCFbxqY1YmoGZVORW/QMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAAjJclj04kifG7PRApFI4NgwtaE5na/xCEBI572Nvp+FkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBHnVW/IxwG7udMVuzmgVB/2xst6j9I5RArHNola8E4+0P/on9df2SnTAmx8pWHneSwmrNt/J3VFLMhqns4zl6JmXkZ+niuxMhAGrmKBaBo94uMv2Sl+Xh3i+VOO0m5BdNZ1ElenbwQylHQY+VW1ydG1MaUEeNpG+EVgswzPMwPoLBgAFAsBcFQAGAAkDQA0DAAAAAAAHBgABAhMICQAHBgADABYICQEBCAIAAwwCAAAAUEYVOwAAAAAJAQMBEQoUCQADBAETCgsKFw0ODxARAwQACRQj5RfLl3rjrSoBAAAAQ2QAAVBGFTsAAAAAyYZnBwAAAABkAAAJAwMAAAEJDAkAAAIBBBMVCQjGASBMKQwnooTbKNxdBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUHTKomh4KXvNgA0ovYKS5F8GIOBgAAAAAAAAAAAAAAAAAQgAAAAAAAAAAAAAAAAAAAAAAAEIF7RFOAwAAAAAAAAAAAAAAaAIAAAAAAAC4CwAAAAAAAOAA2mcAAAAAAAAAAAAAAAAAAAAApapuIXG0FuHSfsU8qME9s/kaic0AAwGCsZdSuxV5eCm+Ria4LEQPgTg4bg65gNrTAefEzpAfPQgCABIMAgAAAAAAAAAAAAAACAIABQwCAAAAsIOFAAAAAAADWk6DVOZO8lMFQg2r0dgfltD6tRL/B1hH3u00UzZdgqkAAxEqIPdq2eRt/F6mHNmFe7iwZpdrtGmHNJMFlK7c6Bc6k6kjBezr6u/tAgvu3OGsJSwSElmcOHZ21imqH/rhJ2KgqDJdBPFH4SYIM1kBAAA=",
        },
      },
      "snapId": "test-snap",
    },
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:1",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "error_message": "Snap error",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_test-bridge",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Solana bridge should successfully submit a transaction 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "SOLaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:1",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_test-bridge",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "solana-account-1",
          "scope": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
          "transaction": "AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAQAHDXLY8oVRIwA8ZdRSGjM5RIZJW8Wv+Twyw3NqU4Hov+OHoHp/dmeDvstKbICW3ezeGR69t3/PTAvdXgZVdJFJXaxkoKXUTWfEAyQyCCG9nwVoDsd10OFdnM9ldSi+9SLqHpqWVDV+zzkmftkF//DpbXxqeH8obNXHFR7pUlxG9uNVOn64oNsFdeUvD139j1M51iRmUY839Y25ET4jDRscT081oGb+rLnywLjLSrIQx6MkqNBhCFbxqY1YmoGZVORW/QMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAAjJclj04kifG7PRApFI4NgwtaE5na/xCEBI572Nvp+FkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBHnVW/IxwG7udMVuzmgVB/2xst6j9I5RArHNola8E4+0P/on9df2SnTAmx8pWHneSwmrNt/J3VFLMhqns4zl6JmXkZ+niuxMhAGrmKBaBo94uMv2Sl+Xh3i+VOO0m5BdNZ1ElenbwQylHQY+VW1ydG1MaUEeNpG+EVgswzPMwPoLBgAFAsBcFQAGAAkDQA0DAAAAAAAHBgABAhMICQAHBgADABYICQEBCAIAAwwCAAAAUEYVOwAAAAAJAQMBEQoUCQADBAETCgsKFw0ODxARAwQACRQj5RfLl3rjrSoBAAAAQ2QAAVBGFTsAAAAAyYZnBwAAAABkAAAJAwMAAAEJDAkAAAIBBBMVCQjGASBMKQwnooTbKNxdBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUHTKomh4KXvNgA0ovYKS5F8GIOBgAAAAAAAAAAAAAAAAAQgAAAAAAAAAAAAAAAAAAAAAAAEIF7RFOAwAAAAAAAAAAAAAAaAIAAAAAAAC4CwAAAAAAAOAA2mcAAAAAAAAAAAAAAAAAAAAApapuIXG0FuHSfsU8qME9s/kaic0AAwGCsZdSuxV5eCm+Ria4LEQPgTg4bg65gNrTAefEzpAfPQgCABIMAgAAAAAAAAAAAAAACAIABQwCAAAAsIOFAAAAAAADWk6DVOZO8lMFQg2r0dgfltD6tRL/B1hH3u00UzZdgqkAAxEqIPdq2eRt/F6mHNmFe7iwZpdrtGmHNJMFlK7c6Bc6k6kjBezr6u/tAgvu3OGsJSwSElmcOHZ21imqH/rhJ2KgqDJdBPFH4SYIM1kBAAA=",
        },
      },
      "snapId": "test-snap",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Solana bridge should successfully submit a transaction 2`] = `
{
  "approvalTxId": undefined,
  "chainId": "0x416edef1601be",
  "destinationChainId": "0x1",
  "destinationTokenAddress": "0x...",
  "destinationTokenAmount": "0.5",
  "destinationTokenDecimals": 18,
  "destinationTokenSymbol": "ETH",
  "hash": "signature",
  "id": "signature",
  "isBridgeTx": true,
  "isSolana": true,
  "networkClientId": "test-snap",
  "origin": "test-snap",
  "sourceTokenAddress": "native",
  "sourceTokenAmount": "1000000000",
  "sourceTokenDecimals": 9,
  "sourceTokenSymbol": "SOL",
  "status": "submitted",
  "swapTokenValue": "1",
  "time": 1234567890,
  "txParams": {
    "data": "AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAQAHDXLY8oVRIwA8ZdRSGjM5RIZJW8Wv+Twyw3NqU4Hov+OHoHp/dmeDvstKbICW3ezeGR69t3/PTAvdXgZVdJFJXaxkoKXUTWfEAyQyCCG9nwVoDsd10OFdnM9ldSi+9SLqHpqWVDV+zzkmftkF//DpbXxqeH8obNXHFR7pUlxG9uNVOn64oNsFdeUvD139j1M51iRmUY839Y25ET4jDRscT081oGb+rLnywLjLSrIQx6MkqNBhCFbxqY1YmoGZVORW/QMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAAjJclj04kifG7PRApFI4NgwtaE5na/xCEBI572Nvp+FkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBHnVW/IxwG7udMVuzmgVB/2xst6j9I5RArHNola8E4+0P/on9df2SnTAmx8pWHneSwmrNt/J3VFLMhqns4zl6JmXkZ+niuxMhAGrmKBaBo94uMv2Sl+Xh3i+VOO0m5BdNZ1ElenbwQylHQY+VW1ydG1MaUEeNpG+EVgswzPMwPoLBgAFAsBcFQAGAAkDQA0DAAAAAAAHBgABAhMICQAHBgADABYICQEBCAIAAwwCAAAAUEYVOwAAAAAJAQMBEQoUCQADBAETCgsKFw0ODxARAwQACRQj5RfLl3rjrSoBAAAAQ2QAAVBGFTsAAAAAyYZnBwAAAABkAAAJAwMAAAEJDAkAAAIBBBMVCQjGASBMKQwnooTbKNxdBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUHTKomh4KXvNgA0ovYKS5F8GIOBgAAAAAAAAAAAAAAAAAQgAAAAAAAAAAAAAAAAAAAAAAAEIF7RFOAwAAAAAAAAAAAAAAaAIAAAAAAAC4CwAAAAAAAOAA2mcAAAAAAAAAAAAAAAAAAAAApapuIXG0FuHSfsU8qME9s/kaic0AAwGCsZdSuxV5eCm+Ria4LEQPgTg4bg65gNrTAefEzpAfPQgCABIMAgAAAAAAAAAAAAAACAIABQwCAAAAsIOFAAAAAAADWk6DVOZO8lMFQg2r0dgfltD6tRL/B1hH3u00UzZdgqkAAxEqIPdq2eRt/F6mHNmFe7iwZpdrtGmHNJMFlK7c6Bc6k6kjBezr6u/tAgvu3OGsJSwSElmcOHZ21imqH/rhJ2KgqDJdBPFH4SYIM1kBAAA=",
    "from": "0x123...",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: Solana bridge should successfully submit a transaction 3`] = `
{
  "bridgeTxMetaId": "signature",
}
`;

exports[`BridgeStatusController submitTx: Solana bridge should successfully submit a transaction 4`] = `
{
  "account": "0x123...",
  "actionId": undefined,
  "approvalTxId": undefined,
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 300,
  "featureId": undefined,
  "hasApprovalTx": false,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "signature",
  "pricingData": {
    "amountSent": "1",
    "amountSentInUsd": "100",
    "quotedGasAmount": "0.05",
    "quotedGasInUsd": "5",
    "quotedReturnInUsd": "1000",
  },
  "quote": {
    "bridgeId": "test-bridge",
    "bridges": [
      "test-bridge",
    ],
    "destAsset": {
      "address": "0x...",
      "assetId": "eip155:1/slip44:60",
      "chainId": 1,
      "decimals": 18,
      "name": "Ethereum",
      "symbol": "ETH",
    },
    "destChainId": 1,
    "destTokenAmount": "0.5",
    "feeData": {
      "metabridge": {
        "amount": "1000000",
        "asset": {
          "address": "native",
          "assetId": "eip155:1399811149/slip44:501",
          "chainId": 1151111081099710,
          "decimals": 9,
          "name": "Solana",
          "symbol": "SOL",
        },
      },
    },
    "minDestTokenAmount": "0.475",
    "requestId": "123",
    "srcAsset": {
      "address": "native",
      "assetId": "eip155:1399811149/slip44:501",
      "chainId": 1151111081099710,
      "decimals": 9,
      "name": "Solana",
      "symbol": "SOL",
    },
    "srcChainId": 1151111081099710,
    "srcTokenAmount": "1000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "0.5",
        "destAsset": {
          "address": "0x...",
          "assetId": "eip155:1/slip44:60",
          "chainId": 1,
          "decimals": 18,
          "name": "Ethereum",
          "symbol": "ETH",
        },
        "destChainId": 1,
        "protocol": {
          "displayName": "Test Protocol",
          "icon": "test-icon",
          "name": "test-protocol",
        },
        "srcAmount": "1000000000",
        "srcAsset": {
          "address": "native",
          "assetId": "eip155:1399811149/slip44:501",
          "chainId": 1151111081099710,
          "decimals": 9,
          "name": "Solana",
          "symbol": "SOL",
        },
        "srcChainId": 1151111081099710,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 1151111081099710,
      "txHash": "signature",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "signature",
}
`;

exports[`BridgeStatusController submitTx: Solana bridge should throw error when snap ID is missing 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "SOLaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:1",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_test-bridge",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:1",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "error_message": "Failed to submit cross-chain swap transaction: undefined snap id",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_test-bridge",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Solana swap should handle snap controller errors 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "SOLaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": true,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "USDC",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "solana-account-1",
          "scope": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
          "transaction": "AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAQAHDXLY8oVRIwA8ZdRSGjM5RIZJW8Wv+Twyw3NqU4Hov+OHoHp/dmeDvstKbICW3ezeGR69t3/PTAvdXgZVdJFJXaxkoKXUTWfEAyQyCCG9nwVoDsd10OFdnM9ldSi+9SLqHpqWVDV+zzkmftkF//DpbXxqeH8obNXHFR7pUlxG9uNVOn64oNsFdeUvD139j1M51iRmUY839Y25ET4jDRscT081oGb+rLnywLjLSrIQx6MkqNBhCFbxqY1YmoGZVORW/QMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAAjJclj04kifG7PRApFI4NgwtaE5na/xCEBI572Nvp+FkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBHnVW/IxwG7udMVuzmgVB/2xst6j9I5RArHNola8E4+0P/on9df2SnTAmx8pWHneSwmrNt/J3VFLMhqns4zl6JmXkZ+niuxMhAGrmKBaBo94uMv2Sl+Xh3i+VOO0m5BdNZ1ElenbwQylHQY+VW1ydG1MaUEeNpG+EVgswzPMwPoLBgAFAsBcFQAGAAkDQA0DAAAAAAAHBgABAhMICQAHBgADABYICQEBCAIAAwwCAAAAUEYVOwAAAAAJAQMBEQoUCQADBAETCgsKFw0ODxARAwQACRQj5RfLl3rjrSoBAAAAQ2QAAVBGFTsAAAAAyYZnBwAAAABkAAAJAwMAAAEJDAkAAAIBBBMVCQjGASBMKQwnooTbKNxdBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUHTKomh4KXvNgA0ovYKS5F8GIOBgAAAAAAAAAAAAAAAAAQgAAAAAAAAAAAAAAAAAAAAAAAEIF7RFOAwAAAAAAAAAAAAAAaAIAAAAAAAC4CwAAAAAAAOAA2mcAAAAAAAAAAAAAAAAAAAAApapuIXG0FuHSfsU8qME9s/kaic0AAwGCsZdSuxV5eCm+Ria4LEQPgTg4bg65gNrTAefEzpAfPQgCABIMAgAAAAAAAAAAAAAACAIABQwCAAAAsIOFAAAAAAADWk6DVOZO8lMFQg2r0dgfltD6tRL/B1hH3u00UzZdgqkAAxEqIPdq2eRt/F6mHNmFe7iwZpdrtGmHNJMFlK7c6Bc6k6kjBezr6u/tAgvu3OGsJSwSElmcOHZ21imqH/rhJ2KgqDJdBPFH4SYIM1kBAAA=",
        },
      },
      "snapId": "test-snap",
    },
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "error_message": "Snap error",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": true,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "USDC",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Solana swap should successfully submit a transaction 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "SOLaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": true,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "USDC",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "solana-account-1",
          "scope": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
          "transaction": "AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAQAHDXLY8oVRIwA8ZdRSGjM5RIZJW8Wv+Twyw3NqU4Hov+OHoHp/dmeDvstKbICW3ezeGR69t3/PTAvdXgZVdJFJXaxkoKXUTWfEAyQyCCG9nwVoDsd10OFdnM9ldSi+9SLqHpqWVDV+zzkmftkF//DpbXxqeH8obNXHFR7pUlxG9uNVOn64oNsFdeUvD139j1M51iRmUY839Y25ET4jDRscT081oGb+rLnywLjLSrIQx6MkqNBhCFbxqY1YmoGZVORW/QMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAAjJclj04kifG7PRApFI4NgwtaE5na/xCEBI572Nvp+FkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBHnVW/IxwG7udMVuzmgVB/2xst6j9I5RArHNola8E4+0P/on9df2SnTAmx8pWHneSwmrNt/J3VFLMhqns4zl6JmXkZ+niuxMhAGrmKBaBo94uMv2Sl+Xh3i+VOO0m5BdNZ1ElenbwQylHQY+VW1ydG1MaUEeNpG+EVgswzPMwPoLBgAFAsBcFQAGAAkDQA0DAAAAAAAHBgABAhMICQAHBgADABYICQEBCAIAAwwCAAAAUEYVOwAAAAAJAQMBEQoUCQADBAETCgsKFw0ODxARAwQACRQj5RfLl3rjrSoBAAAAQ2QAAVBGFTsAAAAAyYZnBwAAAABkAAAJAwMAAAEJDAkAAAIBBBMVCQjGASBMKQwnooTbKNxdBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUHTKomh4KXvNgA0ovYKS5F8GIOBgAAAAAAAAAAAAAAAAAQgAAAAAAAAAAAAAAAAAAAAAAAEIF7RFOAwAAAAAAAAAAAAAAaAIAAAAAAAC4CwAAAAAAAOAA2mcAAAAAAAAAAAAAAAAAAAAApapuIXG0FuHSfsU8qME9s/kaic0AAwGCsZdSuxV5eCm+Ria4LEQPgTg4bg65gNrTAefEzpAfPQgCABIMAgAAAAAAAAAAAAAACAIABQwCAAAAsIOFAAAAAAADWk6DVOZO8lMFQg2r0dgfltD6tRL/B1hH3u00UzZdgqkAAxEqIPdq2eRt/F6mHNmFe7iwZpdrtGmHNJMFlK7c6Bc6k6kjBezr6u/tAgvu3OGsJSwSElmcOHZ21imqH/rhJ2KgqDJdBPFH4SYIM1kBAAA=",
        },
      },
      "snapId": "test-snap",
    },
  ],
  [
    "AccountsController:getAccountByAddress",
    "0x123...",
  ],
  [
    "TransactionController:getState",
  ],
]
`;

exports[`BridgeStatusController submitTx: Solana swap should successfully submit a transaction 2`] = `
{
  "approvalTxId": undefined,
  "chainId": "0x416edef1601be",
  "destinationChainId": "0x416edef1601be",
  "destinationTokenAddress": "0x...",
  "destinationTokenAmount": "500000000000000000s",
  "destinationTokenDecimals": 18,
  "destinationTokenSymbol": "USDC",
  "hash": "signature",
  "id": "signature",
  "isBridgeTx": false,
  "isSolana": true,
  "networkClientId": "test-snap",
  "origin": "test-snap",
  "sourceTokenAddress": "native",
  "sourceTokenAmount": "1000000000",
  "sourceTokenDecimals": 9,
  "sourceTokenSymbol": "SOL",
  "status": "submitted",
  "swapTokenValue": "1",
  "time": 1234567890,
  "txParams": {
    "data": "AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAQAHDXLY8oVRIwA8ZdRSGjM5RIZJW8Wv+Twyw3NqU4Hov+OHoHp/dmeDvstKbICW3ezeGR69t3/PTAvdXgZVdJFJXaxkoKXUTWfEAyQyCCG9nwVoDsd10OFdnM9ldSi+9SLqHpqWVDV+zzkmftkF//DpbXxqeH8obNXHFR7pUlxG9uNVOn64oNsFdeUvD139j1M51iRmUY839Y25ET4jDRscT081oGb+rLnywLjLSrIQx6MkqNBhCFbxqY1YmoGZVORW/QMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAAjJclj04kifG7PRApFI4NgwtaE5na/xCEBI572Nvp+FkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBHnVW/IxwG7udMVuzmgVB/2xst6j9I5RArHNola8E4+0P/on9df2SnTAmx8pWHneSwmrNt/J3VFLMhqns4zl6JmXkZ+niuxMhAGrmKBaBo94uMv2Sl+Xh3i+VOO0m5BdNZ1ElenbwQylHQY+VW1ydG1MaUEeNpG+EVgswzPMwPoLBgAFAsBcFQAGAAkDQA0DAAAAAAAHBgABAhMICQAHBgADABYICQEBCAIAAwwCAAAAUEYVOwAAAAAJAQMBEQoUCQADBAETCgsKFw0ODxARAwQACRQj5RfLl3rjrSoBAAAAQ2QAAVBGFTsAAAAAyYZnBwAAAABkAAAJAwMAAAEJDAkAAAIBBBMVCQjGASBMKQwnooTbKNxdBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUHTKomh4KXvNgA0ovYKS5F8GIOBgAAAAAAAAAAAAAAAAAQgAAAAAAAAAAAAAAAAAAAAAAAEIF7RFOAwAAAAAAAAAAAAAAaAIAAAAAAAC4CwAAAAAAAOAA2mcAAAAAAAAAAAAAAAAAAAAApapuIXG0FuHSfsU8qME9s/kaic0AAwGCsZdSuxV5eCm+Ria4LEQPgTg4bg65gNrTAefEzpAfPQgCABIMAgAAAAAAAAAAAAAACAIABQwCAAAAsIOFAAAAAAADWk6DVOZO8lMFQg2r0dgfltD6tRL/B1hH3u00UzZdgqkAAxEqIPdq2eRt/F6mHNmFe7iwZpdrtGmHNJMFlK7c6Bc6k6kjBezr6u/tAgvu3OGsJSwSElmcOHZ21imqH/rhJ2KgqDJdBPFH4SYIM1kBAAA=",
    "from": "0x123...",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: Solana swap should successfully submit a transaction 3`] = `
{
  "account": "0x123...",
  "actionId": undefined,
  "approvalTxId": undefined,
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 300,
  "featureId": undefined,
  "hasApprovalTx": false,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "signature",
  "pricingData": {
    "amountSent": "1",
    "amountSentInUsd": "100",
    "quotedGasAmount": "0.05",
    "quotedGasInUsd": "5",
    "quotedReturnInUsd": "1000",
  },
  "quote": {
    "bridgeId": "test-bridge",
    "bridges": [],
    "destAsset": {
      "address": "0x...",
      "assetId": "eip155:1399811149/slip44:501",
      "chainId": 1151111081099710,
      "decimals": 18,
      "name": "USDC",
      "symbol": "USDC",
    },
    "destChainId": 1151111081099710,
    "destTokenAmount": "500000000000000000s",
    "feeData": {
      "metabridge": {
        "amount": "1000000",
        "asset": {
          "address": "native",
          "assetId": "eip155:1399811149/slip44:501",
          "chainId": 1151111081099710,
          "decimals": 9,
          "name": "Solana",
          "symbol": "SOL",
        },
      },
    },
    "minDestTokenAmount": "475000000000000000s",
    "requestId": "123",
    "srcAsset": {
      "address": "native",
      "assetId": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501",
      "chainId": 1151111081099710,
      "decimals": 9,
      "name": "Solana",
      "symbol": "SOL",
    },
    "srcChainId": 1151111081099710,
    "srcTokenAmount": "1000000000",
    "steps": [
      {
        "action": "bridge",
        "destAmount": "0.5",
        "destAsset": {
          "address": "0x...",
          "assetId": "eip155:1/slip44:60",
          "chainId": 1,
          "decimals": 18,
          "name": "Ethereum",
          "symbol": "ETH",
        },
        "destChainId": 1,
        "protocol": {
          "displayName": "Test Protocol",
          "icon": "test-icon",
          "name": "test-protocol",
        },
        "srcAmount": "1000000000",
        "srcAsset": {
          "address": "native",
          "assetId": "eip155:1399811149/slip44:501",
          "chainId": 1151111081099710,
          "decimals": 9,
          "name": "Solana",
          "symbol": "SOL",
        },
        "srcChainId": 1151111081099710,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 1151111081099710,
      "txHash": "signature",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "signature",
}
`;

exports[`BridgeStatusController submitTx: Solana swap should throw error when account is missing 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "SOLaccountAddress",
  ],
]
`;

exports[`BridgeStatusController submitTx: Solana swap should throw error when snap ID is missing 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "SOLaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "USDC",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "chain_id_source": "solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",
      "custom_slippage": false,
      "error_message": "Failed to submit cross-chain swap transaction: undefined snap id",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "USDC",
      "token_symbol_source": "SOL",
      "usd_amount_source": 100,
      "usd_quoted_gas": 5,
      "usd_quoted_return": 985,
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should handle approval transaction errors 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "TRXaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "tron:728126428",
      "chain_id_source": "tron:728126428",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 0.5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "TRX",
      "token_symbol_source": "USDT",
      "usd_amount_source": 1,
      "usd_quoted_gas": 0.005,
      "usd_quoted_return": 499.99,
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "tron-account-1",
          "options": {
            "type": undefined,
            "visible": undefined,
          },
          "scope": "tron:728126428",
          "transaction": "CgKquyIITd6G0PaK4+VAOmgIAbJjCjF0eXBlLmdvb2dsZWFwaXMuY29tL3Byb3RvY29sLlRyaWdnZXJTbWFydENvbnRyYWN0EjMKFUGPfqjM6fi7pn165ZzUmhll1hfnGhIVQaYU+AO2/XgJhqQseOycf3fm3tE8",
        },
      },
      "snapId": "npm:@metamask/tron-snap",
    },
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "tron:728126428",
      "chain_id_source": "tron:728126428",
      "custom_slippage": false,
      "error_message": "Approval transaction failed",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 0.5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "TRX",
      "token_symbol_source": "USDT",
      "usd_amount_source": 1,
      "usd_quoted_gas": 0.005,
      "usd_quoted_return": 499.99,
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should successfully submit a Tron bridge with approval transaction 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "TRXaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "eip155:1",
      "chain_id_source": "tron:728126428",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 0.5,
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_symbol_destination": "TRX",
      "token_symbol_source": "USDT",
      "usd_amount_source": 1,
      "usd_quoted_gas": 0.005,
      "usd_quoted_return": 499.99,
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "tron-account-1",
          "options": {
            "type": undefined,
            "visible": undefined,
          },
          "scope": "tron:728126428",
          "transaction": "CgKquyIITd6G0PaK4+VAOmgIAbJjCjF0eXBlLmdvb2dsZWFwaXMuY29tL3Byb3RvY29sLlRyaWdnZXJTbWFydENvbnRyYWN0EjMKFUGPfqjM6fi7pn165ZzUmhll1hfnGhIVQaYU+AO2/XgJhqQseOycf3fm3tE8",
        },
      },
      "snapId": "npm:@metamask/tron-snap",
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "tron-account-1",
          "options": {
            "type": undefined,
            "visible": undefined,
          },
          "scope": "tron:728126428",
          "transaction": "CgKquyIITd6G0PaK4+VAOmgIAbJjCjF0eXBlLmdvb2dsZWFwaXMuY29tL3Byb3RvY29sLlRyaWdnZXJTbWFydENvbnRyYWN0EjMKFUGPfqjM6fi7pn165ZzUmhll1hfnGxIVQaYU+AO2/XgJhqQseOycf3fm3tE8",
        },
      },
      "snapId": "npm:@metamask/tron-snap",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should successfully submit a Tron bridge with approval transaction 2`] = `
{
  "approvalTxId": undefined,
  "chainId": "0x2b6653dc",
  "destinationChainId": "0x1",
  "destinationTokenAddress": "native",
  "destinationTokenAmount": "500000000",
  "destinationTokenDecimals": 6,
  "destinationTokenSymbol": "TRX",
  "hash": "bridge-signature",
  "id": "bridge-signature",
  "isBridgeTx": true,
  "isSolana": true,
  "networkClientId": "npm:@metamask/tron-snap",
  "origin": "npm:@metamask/tron-snap",
  "sourceTokenAddress": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
  "sourceTokenAmount": "1000000",
  "sourceTokenDecimals": 6,
  "sourceTokenSymbol": "USDT",
  "status": "submitted",
  "swapTokenValue": "1",
  "time": 1234567890,
  "txParams": {
    "data": "CgKquyIITd6G0PaK4+VAOmgIAbJjCjF0eXBlLmdvb2dsZWFwaXMuY29tL3Byb3RvY29sLlRyaWdnZXJTbWFydENvbnRyYWN0EjMKFUGPfqjM6fi7pn165ZzUmhll1hfnGxIVQaYU+AO2/XgJhqQseOycf3fm3tE8",
    "from": "TRX123...",
  },
  "type": "bridge",
}
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should successfully submit a Tron bridge with approval transaction 3`] = `
{
  "bridgeTxMetaId": "bridge-signature",
}
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should successfully submit a Tron bridge with approval transaction 4`] = `
{
  "account": "TRX123...",
  "actionId": undefined,
  "approvalTxId": "approval-signature",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 30,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "bridge-signature",
  "pricingData": {
    "amountSent": "1",
    "amountSentInUsd": "1",
    "quotedGasAmount": "0.005",
    "quotedGasInUsd": "0.005",
    "quotedReturnInUsd": "500",
  },
  "quote": {
    "bridgeId": "test-bridge",
    "bridges": [],
    "destAsset": {
      "address": "native",
      "assetId": "tron:728126428/slip44:195",
      "chainId": 728126428,
      "decimals": 6,
      "name": "Tron",
      "symbol": "TRX",
    },
    "destChainId": 1,
    "destTokenAmount": "500000000",
    "feeData": {
      "metabridge": {
        "amount": "10000",
        "asset": {
          "address": "native",
          "assetId": "tron:728126428/slip44:195",
          "chainId": 728126428,
          "decimals": 6,
          "name": "Tron",
          "symbol": "TRX",
        },
      },
    },
    "minDestTokenAmount": "475000000",
    "requestId": "123",
    "srcAsset": {
      "address": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
      "assetId": "tron:728126428/slip44:195",
      "chainId": 728126428,
      "decimals": 6,
      "name": "Tether USD",
      "symbol": "USDT",
    },
    "srcChainId": 728126428,
    "srcTokenAmount": "1000000",
    "steps": [
      {
        "action": "swap",
        "destAmount": "500000000",
        "destAsset": {
          "address": "native",
          "assetId": "tron:728126428/slip44:195",
          "chainId": 728126428,
          "decimals": 6,
          "name": "Tron",
          "symbol": "TRX",
        },
        "destChainId": 728126428,
        "protocol": {
          "displayName": "Test Protocol",
          "icon": "test-icon",
          "name": "test-protocol",
        },
        "srcAmount": "1000000",
        "srcAsset": {
          "address": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
          "assetId": "tron:728126428/slip44:195",
          "chainId": 728126428,
          "decimals": 6,
          "name": "Tether USD",
          "symbol": "USDT",
        },
        "srcChainId": 728126428,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 728126428,
      "txHash": "bridge-signature",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "bridge-signature",
}
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should successfully submit a Tron swap with approval transaction 1`] = `
[
  [
    "BridgeController:stopPollingForQuotes",
    "Transaction submitted",
    undefined,
  ],
  [
    "AccountsController:getAccountByAddress",
    "TRXaccountAddress",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Submitted",
    {
      "action_type": "swapbridge-v1",
      "chain_id_destination": "tron:728126428",
      "chain_id_source": "tron:728126428",
      "custom_slippage": false,
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "test-bridge_undefined",
      "quoted_time_minutes": 0.5,
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_symbol_destination": "TRX",
      "token_symbol_source": "USDT",
      "usd_amount_source": 1,
      "usd_quoted_gas": 0.005,
      "usd_quoted_return": 499.99,
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "tron-account-1",
          "options": {
            "type": undefined,
            "visible": undefined,
          },
          "scope": "tron:728126428",
          "transaction": "CgKquyIITd6G0PaK4+VAOmgIAbJjCjF0eXBlLmdvb2dsZWFwaXMuY29tL3Byb3RvY29sLlRyaWdnZXJTbWFydENvbnRyYWN0EjMKFUGPfqjM6fi7pn165ZzUmhll1hfnGhIVQaYU+AO2/XgJhqQseOycf3fm3tE8",
        },
      },
      "snapId": "npm:@metamask/tron-snap",
    },
  ],
  [
    "SnapController:handleRequest",
    {
      "handler": "onClientRequest",
      "origin": "metamask",
      "request": {
        "id": "test-uuid-1234",
        "jsonrpc": "2.0",
        "method": "signAndSendTransaction",
        "params": {
          "accountId": "tron-account-1",
          "options": {
            "type": undefined,
            "visible": undefined,
          },
          "scope": "tron:728126428",
          "transaction": "CgKquyIITd6G0PaK4+VAOmgIAbJjCjF0eXBlLmdvb2dsZWFwaXMuY29tL3Byb3RvY29sLlRyaWdnZXJTbWFydENvbnRyYWN0EjMKFUGPfqjM6fi7pn165ZzUmhll1hfnGxIVQaYU+AO2/XgJhqQseOycf3fm3tE8",
        },
      },
      "snapId": "npm:@metamask/tron-snap",
    },
  ],
]
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should successfully submit a Tron swap with approval transaction 2`] = `
{
  "approvalTxId": undefined,
  "chainId": "0x2b6653dc",
  "destinationChainId": "0x2b6653dc",
  "destinationTokenAddress": "native",
  "destinationTokenAmount": "500000000",
  "destinationTokenDecimals": 6,
  "destinationTokenSymbol": "TRX",
  "hash": "swap-signature",
  "id": "swap-signature",
  "isBridgeTx": false,
  "isSolana": true,
  "networkClientId": "npm:@metamask/tron-snap",
  "origin": "npm:@metamask/tron-snap",
  "sourceTokenAddress": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
  "sourceTokenAmount": "1000000",
  "sourceTokenDecimals": 6,
  "sourceTokenSymbol": "USDT",
  "status": "submitted",
  "swapTokenValue": "1",
  "time": 1234567890,
  "txParams": {
    "data": "CgKquyIITd6G0PaK4+VAOmgIAbJjCjF0eXBlLmdvb2dsZWFwaXMuY29tL3Byb3RvY29sLlRyaWdnZXJTbWFydENvbnRyYWN0EjMKFUGPfqjM6fi7pn165ZzUmhll1hfnGxIVQaYU+AO2/XgJhqQseOycf3fm3tE8",
    "from": "TRX123...",
  },
  "type": "swap",
}
`;

exports[`BridgeStatusController submitTx: Tron swap with approval should successfully submit a Tron swap with approval transaction 3`] = `
{
  "account": "TRX123...",
  "actionId": undefined,
  "approvalTxId": "approval-signature",
  "batchId": undefined,
  "estimatedProcessingTimeInSeconds": 30,
  "featureId": undefined,
  "hasApprovalTx": true,
  "initialDestAssetBalance": undefined,
  "isStxEnabled": false,
  "location": "Main View",
  "originalTransactionId": "swap-signature",
  "pricingData": {
    "amountSent": "1",
    "amountSentInUsd": "1",
    "quotedGasAmount": "0.005",
    "quotedGasInUsd": "0.005",
    "quotedReturnInUsd": "500",
  },
  "quote": {
    "bridgeId": "test-bridge",
    "bridges": [],
    "destAsset": {
      "address": "native",
      "assetId": "tron:728126428/slip44:195",
      "chainId": 728126428,
      "decimals": 6,
      "name": "Tron",
      "symbol": "TRX",
    },
    "destChainId": 728126428,
    "destTokenAmount": "500000000",
    "feeData": {
      "metabridge": {
        "amount": "10000",
        "asset": {
          "address": "native",
          "assetId": "tron:728126428/slip44:195",
          "chainId": 728126428,
          "decimals": 6,
          "name": "Tron",
          "symbol": "TRX",
        },
      },
    },
    "minDestTokenAmount": "475000000",
    "requestId": "123",
    "srcAsset": {
      "address": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
      "assetId": "tron:728126428/slip44:195",
      "chainId": 728126428,
      "decimals": 6,
      "name": "Tether USD",
      "symbol": "USDT",
    },
    "srcChainId": 728126428,
    "srcTokenAmount": "1000000",
    "steps": [
      {
        "action": "swap",
        "destAmount": "500000000",
        "destAsset": {
          "address": "native",
          "assetId": "tron:728126428/slip44:195",
          "chainId": 728126428,
          "decimals": 6,
          "name": "Tron",
          "symbol": "TRX",
        },
        "destChainId": 728126428,
        "protocol": {
          "displayName": "Test Protocol",
          "icon": "test-icon",
          "name": "test-protocol",
        },
        "srcAmount": "1000000",
        "srcAsset": {
          "address": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
          "assetId": "tron:728126428/slip44:195",
          "chainId": 728126428,
          "decimals": 6,
          "name": "Tether USD",
          "symbol": "USDT",
        },
        "srcChainId": 728126428,
      },
    ],
  },
  "slippagePercentage": 0,
  "startTime": 1234567890,
  "status": {
    "srcChain": {
      "chainId": 728126428,
      "txHash": "swap-signature",
    },
    "status": "PENDING",
  },
  "targetContractAddress": undefined,
  "txMetaId": "swap-signature",
}
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionConfirmed should not start polling for bridge tx if tx is not in txHistory 1`] = `[]`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionConfirmed should not track completed event for other transaction types 1`] = `[]`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionConfirmed should start polling for bridge tx if status response is invalid 1`] = `
[
  "BridgeController:trackUnifiedSwapBridgeEvent",
  "Unified SwapBridge Status Failed Validation",
  {
    "action_type": "swapbridge-v1",
    "chain_id_destination": "eip155:10",
    "chain_id_source": "eip155:42161",
    "failures": [
      "across|unknown",
    ],
    "location": "Main View",
    "refresh_count": 0,
    "token_address_destination": "eip155:10/slip44:60",
    "token_address_source": "eip155:42161/slip44:60",
  },
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionConfirmed should start polling for bridge tx if status response is invalid 2`] = `
[
  [
    "Failed to fetch bridge tx status",
    [Error: Bridge status validation failed: across|status],
  ],
  [
    "Failed to fetch bridge tx status",
    [Error: Bridge status validation failed: across|unknown],
  ],
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionConfirmed should start polling for completed bridge tx with featureId 2`] = `
{
  "bridge": "across",
  "destChain": {
    "amount": "990654755978611",
    "chainId": 10,
    "token": {
      "address": "0x0000000000000000000000000000000000000000",
      "chainId": 10,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.63",
      "symbol": "ETH",
    },
    "txHash": "0xdestTxHash1",
  },
  "isExpectedToken": true,
  "srcChain": {
    "amount": "991250000000000",
    "chainId": 42161,
    "token": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "logoURI": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "priceUSD": "2478.7",
      "symbol": "ETH",
    },
    "txHash": "0xperpsSrcTxHash1",
  },
  "status": "COMPLETE",
}
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionConfirmed should start polling for failed bridge tx with featureId 2`] = `
{
  "bridge": "debridge",
  "destChain": {
    "chainId": 10,
    "token": {},
  },
  "srcChain": {
    "amount": "991250000000000",
    "chainId": 42161,
    "token": {
      "address": "0x0000000000000000000000000000000000000000",
      "assetId": "eip155:42161/slip44:60",
      "chainId": 42161,
      "coinKey": "ETH",
      "decimals": 18,
      "icon": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "iconUrl": "https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",
      "name": "ETH",
      "symbol": "ETH",
    },
    "txHash": "0xperpsSrcTxHash1",
  },
  "status": "FAILED",
}
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionConfirmed should track completed event for swap transaction 1`] = `
[
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Completed",
    {
      "action_type": "swapbridge-v1",
      "actual_time_minutes": 0,
      "allowance_reset_transaction": undefined,
      "approval_transaction": undefined,
      "chain_id_destination": "eip155:42161",
      "chain_id_source": "eip155:42161",
      "custom_slippage": true,
      "destination_transaction": "PENDING",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quote_vs_execution_ratio": 0,
      "quoted_time_minutes": 0.25,
      "quoted_vs_used_gas_ratio": 0,
      "security_warnings": [],
      "slippage_limit": 0,
      "source_transaction": "COMPLETE",
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_address_destination": "eip155:42161/slip44:60",
      "token_address_source": "eip155:42161/slip44:60",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_actual_gas": 0,
      "usd_actual_return": 0,
      "usd_amount_source": 0,
      "usd_quoted_gas": 0,
      "usd_quoted_return": 0,
    },
  ],
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should find history by actionId when txMeta.id not in history (pre-submission failure) 1`] = `
[
  "BridgeController:trackUnifiedSwapBridgeEvent",
  "Unified SwapBridge Failed",
  {
    "action_type": "swapbridge-v1",
    "actual_time_minutes": 0,
    "allowance_reset_transaction": undefined,
    "approval_transaction": undefined,
    "chain_id_destination": "eip155:10",
    "chain_id_source": "eip155:42161",
    "custom_slippage": true,
    "destination_transaction": "FAILED",
    "error_message": "",
    "gas_included": false,
    "gas_included_7702": false,
    "is_hardware_wallet": false,
    "location": "Main View",
    "price_impact": 0,
    "provider": "lifi_across",
    "quote_vs_execution_ratio": 0,
    "quoted_time_minutes": 0.25,
    "quoted_vs_used_gas_ratio": 0,
    "security_warnings": [],
    "slippage_limit": 0,
    "source_transaction": "COMPLETE",
    "stx_enabled": false,
    "swap_type": "crosschain",
    "token_address_destination": "eip155:10/slip44:60",
    "token_address_source": "eip155:42161/slip44:60",
    "token_symbol_destination": "ETH",
    "token_symbol_source": "ETH",
    "usd_actual_gas": 0,
    "usd_actual_return": 0,
    "usd_amount_source": 0,
    "usd_quoted_gas": 2.5778,
    "usd_quoted_return": 0,
  },
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should not track failed event for approved status 1`] = `[]`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should not track failed event for other transaction types 1`] = `[]`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should not track failed event for signed status 1`] = `[]`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should track failed event for bridge transaction 1`] = `
[
  "BridgeController:trackUnifiedSwapBridgeEvent",
  "Unified SwapBridge Failed",
  {
    "action_type": "swapbridge-v1",
    "actual_time_minutes": 0,
    "allowance_reset_transaction": undefined,
    "approval_transaction": undefined,
    "chain_id_destination": "eip155:10",
    "chain_id_source": "eip155:42161",
    "custom_slippage": true,
    "destination_transaction": "FAILED",
    "error_message": "",
    "gas_included": false,
    "gas_included_7702": false,
    "is_hardware_wallet": false,
    "location": "Main View",
    "price_impact": 0,
    "provider": "lifi_across",
    "quote_vs_execution_ratio": 0,
    "quoted_time_minutes": 0.25,
    "quoted_vs_used_gas_ratio": 0,
    "security_warnings": [],
    "slippage_limit": 0,
    "source_transaction": "COMPLETE",
    "stx_enabled": false,
    "swap_type": "crosschain",
    "token_address_destination": "eip155:10/slip44:60",
    "token_address_source": "eip155:42161/slip44:60",
    "token_symbol_destination": "ETH",
    "token_symbol_source": "ETH",
    "usd_actual_gas": 0,
    "usd_actual_return": 0,
    "usd_amount_source": 0,
    "usd_quoted_gas": 2.5778,
    "usd_quoted_return": 0,
  },
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should track failed event for bridge transaction if approval is dropped 1`] = `
[
  "BridgeController:trackUnifiedSwapBridgeEvent",
  "Unified SwapBridge Failed",
  {
    "action_type": "swapbridge-v1",
    "actual_time_minutes": 0,
    "chain_id_destination": "eip155:42161",
    "chain_id_source": "eip155:42161",
    "custom_slippage": false,
    "error_message": "",
    "gas_included": false,
    "gas_included_7702": false,
    "is_hardware_wallet": false,
    "location": "Main View",
    "price_impact": 0,
    "provider": "",
    "quote_vs_execution_ratio": 0,
    "quoted_time_minutes": 0,
    "quoted_vs_used_gas_ratio": 0,
    "security_warnings": [],
    "source_transaction": "FAILED",
    "stx_enabled": false,
    "swap_type": "crosschain",
    "token_address_destination": "eip155:42161/slip44:60",
    "token_address_source": "eip155:42161/slip44:60",
    "token_symbol_destination": "",
    "token_symbol_source": "",
    "usd_actual_gas": 0,
    "usd_actual_return": 0,
    "usd_amount_source": 0,
    "usd_quoted_gas": 0,
    "usd_quoted_return": 0,
  },
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should track failed event for bridge transaction if not in txHistory 1`] = `
[
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "actual_time_minutes": 0,
      "chain_id_destination": "eip155:42161",
      "chain_id_source": "eip155:42161",
      "custom_slippage": false,
      "error_message": "",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "",
      "quote_vs_execution_ratio": 0,
      "quoted_time_minutes": 0,
      "quoted_vs_used_gas_ratio": 0,
      "security_warnings": [],
      "source_transaction": "FAILED",
      "stx_enabled": false,
      "swap_type": "crosschain",
      "token_address_destination": "eip155:42161/slip44:60",
      "token_address_source": "eip155:42161/slip44:60",
      "token_symbol_destination": "",
      "token_symbol_source": "",
      "usd_actual_gas": 0,
      "usd_actual_return": 0,
      "usd_amount_source": 0,
      "usd_quoted_gas": 0,
      "usd_quoted_return": 0,
    },
  ],
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should track failed event for swap transaction 1`] = `
[
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Failed",
    {
      "action_type": "swapbridge-v1",
      "actual_time_minutes": 0,
      "allowance_reset_transaction": undefined,
      "approval_transaction": undefined,
      "chain_id_destination": "eip155:42161",
      "chain_id_source": "eip155:42161",
      "custom_slippage": true,
      "destination_transaction": "FAILED",
      "error_message": "",
      "gas_included": false,
      "gas_included_7702": false,
      "is_hardware_wallet": false,
      "location": "Main View",
      "price_impact": 0,
      "provider": "lifi_across",
      "quote_vs_execution_ratio": 0,
      "quoted_time_minutes": 0.25,
      "quoted_vs_used_gas_ratio": 0,
      "security_warnings": [],
      "slippage_limit": 0,
      "source_transaction": "COMPLETE",
      "stx_enabled": false,
      "swap_type": "single_chain",
      "token_address_destination": "eip155:42161/slip44:60",
      "token_address_source": "eip155:42161/slip44:60",
      "token_symbol_destination": "ETH",
      "token_symbol_source": "ETH",
      "usd_actual_gas": 0,
      "usd_actual_return": 0,
      "usd_amount_source": 0,
      "usd_quoted_gas": 0,
      "usd_quoted_return": 0,
    },
  ],
]
`;

exports[`BridgeStatusController subscription handlers TransactionController:transactionFailed should track failed event for swap transaction if approval fails 1`] = `
[
  "BridgeController:trackUnifiedSwapBridgeEvent",
  "Unified SwapBridge Failed",
  {
    "action_type": "swapbridge-v1",
    "actual_time_minutes": 0,
    "chain_id_destination": "eip155:42161",
    "chain_id_source": "eip155:42161",
    "custom_slippage": false,
    "error_message": "",
    "gas_included": false,
    "gas_included_7702": false,
    "is_hardware_wallet": false,
    "location": "Main View",
    "price_impact": 0,
    "provider": "",
    "quote_vs_execution_ratio": 0,
    "quoted_time_minutes": 0,
    "quoted_vs_used_gas_ratio": 0,
    "security_warnings": [],
    "source_transaction": "FAILED",
    "stx_enabled": false,
    "swap_type": "single_chain",
    "token_address_destination": "eip155:42161/slip44:60",
    "token_address_source": "eip155:42161/slip44:60",
    "token_symbol_destination": "",
    "token_symbol_source": "",
    "usd_actual_gas": 0,
    "usd_actual_return": 0,
    "usd_amount_source": 0,
    "usd_quoted_gas": 0,
    "usd_quoted_return": 0,
  },
]
`;

exports[`BridgeStatusController wipeBridgeStatus wipes the bridge status for the given address 1`] = `
[
  [
    "AuthenticationController:getBearerToken",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount1",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Completed",
  ],
  [
    "AuthenticationController:getBearerToken",
  ],
  [
    "AccountsController:getAccountByAddress",
    "0xaccount2",
  ],
  [
    "TransactionController:getState",
  ],
  [
    "BridgeController:trackUnifiedSwapBridgeEvent",
    "Unified SwapBridge Completed",
  ],
  [
    "NetworkController:getState",
  ],
  [
    "NetworkController:getNetworkClientById",
    "networkClientId",
  ],
]
`;
